var stationList = ["RAJ", "SACHIN", "JEEVAN"],
editReservationFormButton = void 0,
shareFeedbackButton = void 0,
aboutButton = void 0,
guideButton = void 0,
dirtyFlag = void 0,
isExtensionNewlyInstalled = !1,
aboutPopup = void 0,
addGuidePopup = void 0,
alertPopup = void 0,
alertPopupCallbackFunc = void 0,
alertPopupArgs = void 0,
isDirty = void 0,
ztFormList = void 0,
selectedFormID = void 0,
selectedFormDetails = void 0,
ZAPTATKAL_FORMID = "ztFormID_",
ZT_FORM_NAME = "ztFormName_",
LOGIN_DETAILS = "loginDetails_",
JP_DETAILS = "jpDetails_",
TRAIN_DETAILS =
	"trainDetails_",
	PAS_DETAILS = "passengerDetails_",
	CHILD_PAS_DETAILS = "childPassengerDetails_",
	PAYMENT_DETAILS = "paymentDetails_",
	CARD_DETAILS = "cardDetails_",
	ADDITIONAL_DETAILS = "additionalDetails_",
	CLEAR_ADULT_PSG_DETAILS = "clearadultpsgd_",
	CLEAR_INFANT_PSG_DETAILS = "clearinfantd_",
	currentFormCount = void 0,
	DEFAULT_FORM_NAME = "Untitled-",
	curDOJ = void 0;
document.addEventListener("DOMContentLoaded", function() {
	addEventListeners();
	addValidationForNumberControls();
	initializeScroller();
	initialize();
	chrome.storage.local.get("isZapTatkalNew", checkIfExtensionNewlyInstalled);
//	showAboutPopup();
	$('#closeAboutPopup').on("click", hideAboutPopup);
	addDirtyFlagEventListener();
	dirtyFlag = document.getElementById("dirtyFlag");
	showFormContainer()
});

function showInstructionsContainer() {
	document.getElementById("instructionsContainer").style.display = "block";
	guideButton.classList.add("active");
	document.getElementById("formContainer").style.display = "none";
	editReservationFormButton.classList.remove("active");
	document.getElementById("feedbackContainer").style.display = "none";
	shareFeedbackButton.classList.remove("active");
	document.getElementById("aboutContainer").style.display = "none";
	aboutButton.classList.remove("active")
}

function showFormContainer() {
	document.getElementById("instructionsContainer").style.display = "none";
	guideButton.classList.remove("active");
	document.getElementById("formContainer").style.display = "block";
	editReservationFormButton.classList.add("active");
	document.getElementById("feedbackContainer").style.display = "none";
	shareFeedbackButton.classList.remove("active");
	document.getElementById("aboutContainer").style.display = "none";
	aboutButton.classList.remove("active")
}

function showShareFeedbackContainer() {
	document.getElementById("instructionsContainer").style.display = "none";
	guideButton.classList.remove("active");
	document.getElementById("formContainer").style.display = "none";
	editReservationFormButton.classList.remove("active");
	document.getElementById("feedbackContainer").style.display = "block";
	shareFeedbackButton.classList.add("active");
	document.getElementById("aboutContainer").style.display = "none";
	aboutButton.classList.remove("active")
}

function showAboutContainer() {
	document.getElementById("instructionsContainer").style.display = "none";
	guideButton.classList.remove("active");
	document.getElementById("formContainer").style.display = "none";
	editReservationFormButton.classList.remove("active");
	document.getElementById("feedbackContainer").style.display = "none";
	shareFeedbackButton.classList.remove("active");
	document.getElementById("aboutContainer").style.display = "block";
	aboutButton.classList.add("active")
}

function checkIfExtensionNewlyInstalled(a) {
	a ? (isExtensionNewlyInstalled = a.isZapTatkalNew, void 0 == isExtensionNewlyInstalled && (isExtensionNewlyInstalled = !0)) : isExtensionNewlyInstalled = !0;
	isExtensionNewlyInstalled && (setDirtyFlag(), chrome.storage.local.set({
		isZapTatkalNew: !1
	}), showAboutPopup())
}

function showAboutPopup() {
	aboutPopup && (aboutPopup.style.display = "block", aboutPopup.classList.add("active"), document.body.style.overflow = "hidden")
}

function hideAboutPopup() {
	aboutPopup && (aboutPopup.classList.remove("active"), document.body.style.overflow = "inherit")
}

function handlePopupTransitionEnd() {
	aboutPopup.classList.contains("active") || (aboutPopup.style.display = "none");
	alertPopup.classList.contains("active") || (alertPopup.style.display = "none")
}

function showAlertBox(a, b, c) {
	if (alertPopup) {
		alertPopup.style.display = "block";
		alertPopup.classList.add("active");
		document.body.style.overflow = "hidden";
		alertPopupCallbackFunc = b;
		if ((b = document.getElementById("alertPopupMessage")) && a) b.innerHTML = a;
		alertPopupArgs = c
	}
}

function handleAlertPopupOKButton() {
	alertPopupCallbackFunc && alertPopupCallbackFunc(!0, alertPopupArgs);
	alertPopup && (alertPopup.classList.remove("active"), document.body.style.overflow = "inherit");
	alertPopupArgs = alertPopupCallbackFunc = void 0
}

function handleAlertPopupCancelButton() {
	alertPopupCallbackFunc && alertPopupCallbackFunc(!1, alertPopupArgs);
	alertPopup && (alertPopup.classList.remove("active"), document.body.style.overflow = "inherit");
	alertPopupArgs = alertPopupCallbackFunc = void 0
}

function updatePassengerDetailsForm() {
	var a = document.getElementById("ztPHConcessionInput"),
	b = document.getElementById("PH"),
	c = document.getElementById("ztAdultPsgDetails");
	a.checked || b.checked ? c.classList.add("adjustForPH") : c.classList.remove("adjustForPH")
}

function addDirtyFlagEventListener() {
	for (var a = $("input"), b = 0; b < a.length; ++b) {
		var c = a[b];
		c && c.addEventListener("input", setDirtyFlag)
	}
	a = $("input[type=checkbox]");
	for (b = 0; b < a.length; ++b)(c = a[b]) && c.addEventListener("change", setDirtyFlag);
	a = $("input[type=radio]");
	for (b = 0; b < a.length; ++b)(c = a[b]) && c.addEventListener("change", setDirtyFlag);
	a = $("select");
	for (b = 0; b < a.length; ++b)(c = a[b]) && c.addEventListener("change", setDirtyFlag)
}

function setDirtyFlag() {
	dirtyFlag.classList.contains("clean") && dirtyFlag.classList.remove("clean");
	document.getElementById("submitText").innerHTML = "SAVE CHANGES";
	document.getElementById("submitButton").style.width = "175px";
	isDirty = !0
}

function clearDirtyFlag() {
	dirtyFlag.classList.contains("clean") || dirtyFlag.classList.add("clean");
	document.getElementById("submitText").innerHTML = "SAVED";
	document.getElementById("submitButton").style.width = "120px";
	isDirty = !1
}

function clearPassengerDetails(a) {
	if ((a = a.target) && a.classList.contains("clearBtn")) 0 == a.id.indexOf(CLEAR_ADULT_PSG_DETAILS) ? (a = a.id.substring(CLEAR_ADULT_PSG_DETAILS.length), resetAdultPassengerDetails(parseInt(a))) : 0 == a.id.indexOf(CLEAR_INFANT_PSG_DETAILS) && (a = a.id.substring(CLEAR_INFANT_PSG_DETAILS.length), resetChildPassengerDetails(parseInt(a)))
}

function addEventListeners() {
	$("#fromStation").autocomplete({
		source: autocompleteSource
	});
	$("#toStation").autocomplete({
		source: autocompleteSource
	});
	$("#boardingStation").autocomplete({
		source: autocompleteSource
	});
	editReservationFormButton = document.getElementById("reservationFormButton");
	editReservationFormButton.addEventListener("click", showFormContainer);
	shareFeedbackButton = document.getElementById("feedbackFormButton");
	shareFeedbackButton.addEventListener("click", showShareFeedbackContainer);
	aboutButton = document.getElementById("aboutButton");
	aboutButton.addEventListener("click", showAboutContainer);
	guideButton = document.getElementById("guideButton");
	guideButton.addEventListener("click", showInstructionsContainer);
	$("#ztDatePickerBtn").click(function() {
		$("#journeyDateInputDate").datepicker("show")
	});
	$("#journeyDateInputDate").datepicker({
		minDate: 0,
		onSelect: function() {
			var a = document.getElementById("journeyDateInputDate").value;
			curDOJ != a && setDirtyFlag();
			curDOJ = a
		}
	});
	$("#journeyDateInputDate").datepicker("option", "dateFormat", "dd-mm-yy");
	$("#journeyDateInputDate").datepicker("option", "firstDay", "1");
	$("#journeyDateInputDate").datepicker("option", "numberOfMonths", [1, 2]);
	document.getElementById("ztPHConcessionInput").addEventListener("change", updatePassengerDetailsForm);
	for (var a = $("#qcbd input"), b = 0; b < a.length; ++b) {
		var c = a[b];
		c && c.addEventListener("change", updatePassengerDetailsForm)
	}
	document.getElementById("submitButton").addEventListener("click", submitForm);
//	document.getElementById("reset").addEventListener("click", resetForm);
	a = $("#paymentType input");
	for (b = 0; b < a.length; ++b)(c = a[b]) && c.addEventListener("change", paymentOptionChanged);
	(b = document.getElementById("bankPGList")) &&
	b.addEventListener("change", showCreditCardDetailsDiv);
	(b = document.getElementById("bankPrepaidList")) && b.addEventListener("change", showIRCTCPrepaidCardDetailsDiv);
	(b = document.getElementById("bankEMIList")) && b.addEventListener("change", showEMICardDetailsDiv);
	aboutPopup = document.getElementById("aboutPopup");
	aboutPopup.addEventListener("mouseup", hideAboutPopup);
	aboutPopup.addEventListener("webkitTransitionEnd", handlePopupTransitionEnd);
	alertPopup = document.getElementById("alertPopup");
	alertPopup.addEventListener("webkitTransitionEnd",
			handlePopupTransitionEnd);
	document.getElementById("ok").addEventListener("click", handleAlertPopupOKButton);
	document.getElementById("cancel").addEventListener("click", handleAlertPopupCancelButton);
	document.getElementById("aboutPopupContent").addEventListener("mouseup", function(a) {
		a.stopPropagation()
	});
	document.getElementById("ztFormLeftContainer") && (ztFormLeftContainer.addEventListener("mouseover", handleMouseOverFormListContainer), ztFormLeftContainer.addEventListener("mouseout", handleMouseOutFormListContainer));
	(b = document.getElementById("ztDeleteForm")) && b.addEventListener("click", deleteForm);
	(b = document.getElementById("ztAddForm")) && b.addEventListener("click", addNewForm);
	$(document).on("keydown", function(a) {
		if (a.ctrlKey && a.which === 83) {
			console.log("Ctrl+S!");
			submitForm();
			return false
		}
	});
	(b = document.getElementById("swapToNFro")) && b.addEventListener("click", swapToNFroStations);
	var d = document.getElementById("prefCoachOpt");
	d && d.addEventListener("change", function() {
		document.getElementById("coachID").value =
			"";
		d.checked ? document.getElementById("coachID").disabled = false : document.getElementById("coachID").disabled = true
	});
	if (a = document.getElementsByClassName("clearBtn"))
		for (b = 0; b < a.length; ++b)(c = a[b]) && c.addEventListener("click", clearPassengerDetails)
}

function handleMouseOutFormListContainer() {
	if (formListControl = document.getElementById("formList"))
		for (var a = formListControl.children.length, b = 0; b < a; ++b) {
			var c = formListControl.children[b];
			c && (c.style.transitionDelay = 30 * (a - b - 1) + "ms")
		}
}

function handleMouseOverFormListContainer() {
	if (formListControl = document.getElementById("formList"))
		for (var a = formListControl.children.length, b = 0; b < a; ++b) {
			var c = formListControl.children[b];
			c && (c.style.transitionDelay = 30 * b + "ms")
		}
}

function autocompleteSource(a, b) {
	var c = [],
	d = a.term.toLowerCase(),
	e = stationName.length;
	for (i = 0; i < e; ++i) {
		var f = stationName[i].toLowerCase();
		(0 == f.indexOf(d) || -1 != f.indexOf(" " + d)) && c.push(stationName[i])
	}
	b(c)
}

function paymentOptionChanged(a) {
	var a = a.target,
	b = document.getElementById("cardDetailsID"),
	c = document.getElementById("NETBANKING");
	"NETBANKING" != a.value && (c.style.display = "none");
	c = document.getElementById("CREDIT_CARD");
	"CREDIT_CARD" != a.value && (c.style.display = "none");
	c = document.getElementById("DEBIT_CARD");
	"DEBIT_CARD" != a.value && (c.style.display = "none");
	c = document.getElementById("CASH_CARD");
	"CASH_CARD" != a.value && (c.style.display = "none");
	c = document.getElementById("IRCTC_PREPAID");
	"IRCTC_PREPAID" !=
		a.value && (c.style.display = "none");
	c = document.getElementById("EMI");
	"EMI" != a.value && (c.style.display = "none");
	if (c = document.getElementById(a.value)) c.style.display = "block";
	"CREDIT_CARD" == a.value ? showCreditCardDetailsDiv() : "EMI" == a.value ? showEMICardDetailsDiv() : "IRCTC_PREPAID" == a.value ? showIRCTCPrepaidCardDetailsDiv() : b.style.display = "none"
}

function showCreditCardDetailsDiv() {
	var a = document.getElementById("bankPGList");
	if (a) {
		var b = document.getElementById("cardDetailsID");
		b.classList.remove("ztPrepaidCard");
		b.style.display = 27 != a.value && 30 != a.value && 58 != a.value ? "block" : "none"
	}
}

function hideCreditCardDetailsDiv() {
	var a = document.getElementById("cardDetailsID");
	a.classList.remove("ztPrepaidCard");
	a && (a.style.display = "none")
}

function showIRCTCPrepaidCardDetailsDiv() {
	if (document.getElementById("bankPrepaidList")) {
		var a = document.getElementById("cardDetailsID");
		a && (a.style.display = "block", a.classList.add("ztPrepaidCard"))
	}
}

function showEMICardDetailsDiv() {
	if (document.getElementById("bankEMIList")) {
		var a = document.getElementById("cardDetailsID");
		a.classList.remove("ztPrepaidCard");
		a.style.display = "block"
	}
}

function hideDeleteButton() {
	var a = document.getElementById("ztDeleteForm");
	a && (a.style.display = "none")
}

function showDeleteButton() {
	var a = document.getElementById("ztDeleteForm");
	a && (a.style.display = "inherit")
}

function initialize() {
	chrome.storage.local.get("ztFormList", initializeCB)
}

function initializeCB(a) {
	if (a && (a = a.ztFormList)) ztFormList = a, initializeFormList(), initForm()
}

function initForm() {
	for (var a in ztFormList)
		if (ztFormList.hasOwnProperty(a)) {
			selectedFormID = a;
			break
		}
	initializeFormDetails(selectedFormID)
}

function initializeFormList() {
	var a = document.getElementById("formList");
	if (a) {
		for (; a.firstChild;) a.removeChild(a.firstChild);
		var b = 1,
		c = 0,
		d;
		for (d in ztFormList) ztFormList.hasOwnProperty(d) && ++c;
		currentFormCount = c;
		for (d in ztFormList)
			if (ztFormList.hasOwnProperty(d)) {
				c = document.createElement("div");
				c.classList.add("formButtons");
				var e = document.createTextNode(b);
				c.appendChild(e);
				c.dataset.index = b++;
				c.id = d;
				c.addEventListener("click", openForm);
				a.appendChild(c)
			}
	}
	if (document.getElementById("ztAddForm") &&
			(a = document.getElementById("imageDiv"))) a.style.backgroundImage = 6 > currentFormCount ? "url('../forms/add.svg')" : "url('editForm.svg')"
}

function openForm(a) {
	a.target && a.target.classList.contains("formButtons") && (isDirty ? showAlertBox("You have un-saved changes in your form. Do you want to open anotther form without saving this one ... ? ", openFormAlertCB, a.target.id) : openFormAlertCB(!0, a.target.id))
}

function openFormAlertCB(a, b) {
	a && (initializeFormDetails(b), clearDirtyFlag())
}

function initializeFormDetails(a) {
	!a && !ztFormList ? hideDeleteButton() : (selectedFormID = a, selectedFormDetails = {}, selectedFormDetails.formID = selectedFormID, selectedFormDetails.formName = ztFormList[selectedFormID] || "", document.getElementById("formNameID").value = selectedFormDetails.formName, initializeOtherControlsWithSelectedFormDetails(), showDeleteButton())
}

function initializeOtherControlsWithSelectedFormDetails() {
	chrome.storage.local.get(LOGIN_DETAILS + selectedFormID, initializeLoginControls);
	chrome.storage.local.get(JP_DETAILS + selectedFormID, initializeJPControls);
	chrome.storage.local.get(TRAIN_DETAILS + selectedFormID, initializeTrainDetailControls);
	chrome.storage.local.get(PAS_DETAILS + selectedFormID, initializePassengerDetails);
	chrome.storage.local.get(CHILD_PAS_DETAILS + selectedFormID, initializeChildPassengerDetails);
	chrome.storage.local.get(PAYMENT_DETAILS +
			selectedFormID, initializePaymentDetails);
	chrome.storage.local.get(CARD_DETAILS + selectedFormID, initializeCardDetails);
	chrome.storage.local.get(ADDITIONAL_DETAILS + selectedFormID, intializeAdditionalDetails)
}

function initializeLoginControls(a) {
	if (a && (a = a[LOGIN_DETAILS + selectedFormID])) document.getElementById("usernameId").value = a.usernameId, document.getElementById("j_password").value = a.j_password, selectedFormDetails.loginDetails = a
}

function initializeJPControls(a) {
	if (a && (a = a[[JP_DETAILS + selectedFormID]])) {
		document.getElementById("fromStation").value = a.fromStation;
		document.getElementById("toStation").value = a.toStation;
		document.getElementById("boardingStation").value = a.boardingStation || a.fromStation;
		var b = document.getElementById("journeyDateInputDate");
		b.value = a.doj;
		document.getElementById("ztTicketTypeSelect").value = a.ticketType;
		document.getElementById("ztPHConcessionInput").checked = a.phConcession;
		curDOJ = b.value;
		selectedFormDetails.jpDetails =
			a
	}
}

function initializeTrainDetailControls(a) {
	if (a && (a = a[[TRAIN_DETAILS + selectedFormID]])) {
		for (var b = $("#qcbd input"), c = 0; c < b.length; ++c) {
			var d = b[c];
			d.checked = d && d.value == a.quota ? "checked" : !1
		}
		document.getElementById("trainNumber").value = a.trainNumber;
		b = $("#class input");
		for (c = 0; c < b.length; ++c) d = b[c], d.checked = d && d.value == a.trainClass ? "checked" : !1;
		selectedFormDetails.trainDetails = a
	}
}

function initializePassengerDetails(a) {
	if (a && (a = a[PAS_DETAILS + selectedFormID])) {
		for (var b = 0; b < a.length; ++b) {
			var c = a[b];
			document.getElementById("psgnName" + b).value = c.name || "";
			document.getElementById("psgnAge" + b).value = c.age || "";
			document.getElementById("psgnGender" + b).value = c.gender;
			document.getElementById("mealPref" + b).value = c.mealPref;
			document.getElementById("berthChoice" + b).value = c.berthChoice || "";
			document.getElementById("concessionType" + b).value = c.concessionType || " ";
			document.getElementById("handicapCardNo" +
					b).value = c.handicapCardNo || "";
			document.getElementById("psgnDoB" + b).value = c.DoB || "";
			document.getElementById("validUpto" + b).value = c.validUpto || "";
			document.getElementById("aadhaarCardNumber" + b).value = c.aadhaarCardNumber || "";
			document.getElementById("concessionOpt" + b).checked = c.optConcession
		}
		selectedFormDetails.passengerDetailsList = a
	}
}

function initializeChildPassengerDetails(a) {
	if (a && (a = a[CHILD_PAS_DETAILS + selectedFormID])) {
		for (var b = 0; b < a.length; ++b) {
			var c = a[b];
			document.getElementById("infantName" + b).value = c.infantName || "";
			document.getElementById("infantAge" + b).value = c.infantAge;
			document.getElementById("infantGender" + b).value = c.infantGender
		}
		selectedFormDetails.childPassengerDetailsList = a
	}
}

function intializeAdditionalDetails(a) {
	if (a && (a = a[ADDITIONAL_DETAILS + selectedFormID])) {
		document.getElementById("mobileNo").value = a.mobileNumber || "";
		document.getElementById("autoUpgrade").checked = a.autoUpgrade || !1;
		document.getElementById("onlyConfirmBerths").checked = a.onlyConfirmBerths || !1;
		for (var b = $("#bookingCondRadioButtonGroup input"), c = 0; c < b.length; ++c) {
			var d = b[c];
			d.checked = d && d.value == a.bookingCond ? "checked" : !1
		}
		document.getElementById("prefCoachOpt").checked = a.prefCoachOpt || !1;
		a.prefCoachOpt ?
				(document.getElementById("coachID").disabled = !1, document.getElementById("coachID").value = a.coachID || "") : (document.getElementById("coachID").value = "", document.getElementById("coachID").disabled = !0)
	}
}

function initializePhoneNumberControl(a) {
	a && (a = a[MOBILE_NUMBER + selectedFormID], document.getElementById("mobileNo").value = a || "", selectedFormDetails.mobileNumber = a)
}

function initializeAutoUpgradeControl(a) {
	a && (a = a[AUTOUPGRADE + selectedFormID], document.getElementById("autoUpgrade").checked = a || !1, selectedFormDetails.autoUpgrade = a)
}

function getBankListID(a) {
	if ("NETBANKING" == a) return "bankINBList";
	if ("CREDIT_CARD" == a) return "bankPGList";
	if ("DEBIT_CARD" == a) return "bankDCList";
	if ("CASH_CARD" == a) return "bankCCList";
	if ("EMI" == a) return "bankEMIList";
	if ("IRCTC_PREPAID" == a) return "bankPrepaidList"
}

function initializePaymentDetails(a) {
	if (a && (a = a[PAYMENT_DETAILS + selectedFormID])) {
		for (var b = $("#paymentType input"), c = 0; c < b.length; ++c) {
			var d = b[c];
			d.checked = d && d.value == a.paymentType ? "checked" : !1
		}
		b = document.getElementById("NETBANKING");
		"NETBANKING" != a.paymentType && (b.style.display = "none");
		b = document.getElementById("CREDIT_CARD");
		"CREDIT_CARD" != a.paymentType && (b.style.display = "none");
		b = document.getElementById("DEBIT_CARD");
		"DEBIT_CARD" != a.paymentType && (b.style.display = "none");
		b = document.getElementById("CASH_CARD");
		"CASH_CARD" != a.paymentType && (b.style.display = "none");
		b = document.getElementById("IRCTC_PREPAID");
		"IRCTC_PREPAID" != a.paymentType && (b.style.display = "none");
		b = document.getElementById("EMI");
		"EMI" != a.paymentType && (b.style.display = "none");
		if (b = document.getElementById(a.paymentType))
			if (b.style.display = "block", b = getBankListID(a.paymentType), b = document.getElementById(b)) b.value = a.paymentGateway;
		b = document.getElementById("cardDetailsID");
		"CREDIT_CARD" == a.paymentType ? showCreditCardDetailsDiv() : "EMI" == a.paymentType ?
				showEMICardDetailsDiv() : "IRCTC_PREPAID" == a.paymentType ? showIRCTCPrepaidCardDetailsDiv() : b.style.display = "none";
				selectedFormDetails.paymentDetails = a
	}
}

function initializeCardDetails(a) {
	if (a && (a = a[CARD_DETAILS + selectedFormID])) document.getElementById("card_type_id").value = a.type, document.getElementById("card_no_id").value = refillSpacesForCardNumber(a.number), document.getElementById("card_expiry_mon_id").value = a.expiryMonth, document.getElementById("card_expiry_year_id").value = a.expiryYear, document.getElementById("cvv_no_id").value = a.cvvNum, document.getElementById("card_name_id").value = a.cardName, selectedFormDetails.cardDetails = a
}

function refillSpacesForCardNumber(a) {
	a = a.trim();
	a = a.substring(0, 4) + " " + a.substring(4);
	a = a.substring(0, 9) + " " + a.substring(9);
	a = a.substring(0, 14) + " " + a.substring(14);
	19 < a.length && (a = a.substring(0, 19) + " " + a.substring(19));
	return a
}

function removeSpacesForCardNumber(a) {
	a = a.trim();
	return a = a.replace(/ /g, "")
}

function addNewForm() {
	6 <= currentFormCount || (isDirty ? showAlertBox("You have un-saved changes in your form. Do you want to continue closing the form without saving ... ? ", addNewFormAlertCB) : addNewFormAlertCB(!0))
}

function addNewFormAlertCB(a) {
	!0 == a && (selectedFormDetails = selectedFormID = void 0, resetForm())
}

function deleteForm() {
	selectedFormID && (ztFormList && ztFormList[selectedFormID]) && (delete ztFormList[selectedFormID], chrome.storage.local.set({
		ztFormList: ztFormList
	}), chrome.storage.local.get("selectedForm", getSelectedFormCB))
}

function getSelectedFormCB(a) {
	if (a) {
		a = a.selectedForm;
		if (a == selectedFormID) {
			for (var b in ztFormList) ztFormList.hasOwnProperty(b) && (a = b);
			chrome.storage.local.set({
				selectedForm: a
			})
		}
		selectedFormDetails = selectedFormID = void 0;
		initializeFormList();
		resetForm()
	}
}

function submitForm() {
	chrome.storage.local.get("ztFormList", saveFormToList);
}

function saveFormToList(a) {
	if (a) {
		void 0 == selectedFormID && (selectedFormID = ZAPTATKAL_FORMID + (new Date).getTime(), selectedFormDetails = {}, selectedFormDetails.formID = selectedFormID);
		a = a.ztFormList;
		void 0 == a && (a = {});
		formName = document.getElementById("formNameID").value;
		if (void 0 == formName || "" == formName) {
			var b = Object.keys(a).length + 1;
			formName = DEFAULT_FORM_NAME + b;
			document.getElementById("formNameID").value = formName
		}
		a[selectedFormID] = formName;
		selectedFormDetails.formName = formName;
		ztFormList = a;
		chrome.storage.local.set({
			ztFormList: a
		});
		chrome.storage.local.set({
			selectedForm: selectedFormID
		});
		initializeFormList();
		saveOtherFormDetails();
		showDeleteButton()
	}
}

function saveOtherFormDetails() {
	saveLoginDetails();
	saveJourneyPlanDetails();
	saveTrainDetails();
	savePassengerDetails();
	savePaymentDetails();
	saveCardDetails();
	saveAdditionalFormDetails();
	clearDirtyFlag()
}

function saveLoginDetails() {
	var a = document.getElementById("usernameId"),
	b = document.getElementById("j_password"),
	a = {
		usernameId: a.value,
		j_password: b.value
	};
	selectedFormDetails.loginDetails = a;
	b = {};
	b[LOGIN_DETAILS + selectedFormID] = a;
	chrome.storage.local.set(b)
}

function saveJourneyPlanDetails() {
	var a = document.getElementById("fromStation"),
	b = document.getElementById("toStation"),
	c = document.getElementById("boardingStation"),
	d = document.getElementById("journeyDateInputDate"),
	e = document.getElementById("ztTicketTypeSelect"),
	f = document.getElementById("ztPHConcessionInput"),
	a = {
		fromStation: a.value,
		toStation: b.value,
		boardingStation: c.value,
		doj: d.value,
		ticketType: e.value,
		phConcession: f.checked
	};
	selectedFormDetails.jpDetails = a;
	b = {};
	b[JP_DETAILS + selectedFormID] = a;
	chrome.storage.local.set(b)
}

function saveTrainDetails() {
	var a = $("#qcbd input").filter(":checked").val(),
	b = document.getElementById("trainNumber").value,
	c = $("#class input").filter(":checked").val(),
	a = {
		quota: a,
		trainNumber: b,
		trainClass: c
	};
	selectedFormDetails.trainDetails = a;
	b = {};
	b[TRAIN_DETAILS + selectedFormID] = a;
	chrome.storage.local.set(b)
}

function savePassengerDetails() {
	for (var a = [], b = 0; 6 > b; ++b) {
		var c = document.getElementById("psgnName" + b),
		d = document.getElementById("psgnAge" + b),
		e = document.getElementById("psgnGender" + b),
		f = document.getElementById("berthChoice" + b),
		g = document.getElementById("aadhaarCardNumber" + b),
		h = document.getElementById("concessionOpt" + b),
		j = document.getElementById("mealPref" + b),
		k = document.getElementById("concessionType" + b),
		l = document.getElementById("handicapCardNo" + b),
		m = document.getElementById("psgnDoB" + b),
		n = document.getElementById("validUpto" +
				b);
		a[a.length] = {
				name: c.value,
				age: d.value,
				gender: e.value,
				berthChoice: f.value,
				mealPref: j.value,
				aadhaarCardNumber: g.value,
				optConcession: h.checked,
				concessionType: k.value,
				handicapCardNo: l.value,
				DoB: m.value,
				validUpto: n.value
		}
	}
	selectedFormDetails.passengerDetailsList = a;
	b = {};
	b[PAS_DETAILS + selectedFormID] = a;
	chrome.storage.local.set(b);
	a = [];
	for (b = 0; 2 > b; ++b) c = document.getElementById("infantName" + b), d = document.getElementById("infantAge" + b), e = document.getElementById("infantGender" + b), a[a.length] = {
			infantName: c.value,
			infantAge: d.value,
			infantGender: e.value
	};
	selectedFormDetails.childPassengerDetailsList = a;
	b = {};
	b[CHILD_PAS_DETAILS + selectedFormID] = a;
	chrome.storage.local.set(b)
}

function saveAdditionalFormDetails() {
	var a = {};
	a.mobileNumber = document.getElementById("mobileNo").value;
	a.autoUpgrade = document.getElementById("autoUpgrade").checked;
	a.onlyConfirmBerths = document.getElementById("onlyConfirmBerths").checked;
	a.bookingCond = $("#bookingCondRadioButtonGroup input").filter(":checked").val();
	a.prefCoachOpt = document.getElementById("prefCoachOpt").checked;
	a.coachID = a.prefCoachOpt ? document.getElementById("coachID").value : "";
	selectedFormDetails.additionalDetails = a;
	var b = {};
	b[ADDITIONAL_DETAILS +
	  selectedFormID] = a;
	chrome.storage.local.set(b)
}

function savePaymentDetails() {
	var a = $("#paymentType input").filter(":checked").val(),
	b = void 0;
	"NETBANKING" == a ? b = document.getElementById("bankINBList").value : "CREDIT_CARD" == a ? b = document.getElementById("bankPGList").value : "DEBIT_CARD" == a ? b = document.getElementById("bankDCList").value : "CASH_CARD" == a ? b = document.getElementById("bankCCList").value : "IRCTC_PREPAID" == a ? b = document.getElementById("IRCTC_PREPAID").value : "EMI" == a && (b = document.getElementById("bankEMIList").value);
	a = {
			paymentType: a,
			paymentGateway: b
	};
	selectedFormDetails.paymentDetails = a;
	b = {};
	b[PAYMENT_DETAILS + selectedFormID] = a;
	chrome.storage.local.set(b)
}

function saveCardDetails() {
	var a = document.getElementById("card_type_id").value,
	b = document.getElementById("card_no_id").value,
	b = removeSpacesForCardNumber(b),
	c = document.getElementById("card_expiry_mon_id").value,
	d = document.getElementById("card_expiry_year_id").value,
	e = document.getElementById("cvv_no_id").value,
	f = document.getElementById("card_name_id").value,
	a = {
		type: a,
		number: b,
		expiryYear: d,
		expiryMonth: c,
		cvvNum: e,
		cardName: f
	};
	selectedFormDetails.cardDetails = a;
	b = {};
	b[CARD_DETAILS + selectedFormID] = a;
	chrome.storage.local.set(b)
}

function resetForm() {
	void 0 != selectedFormID && "" != selectedFormID ? initialize() : (resetFormName(), resetLoginDetails(), resetJourneyPlanDetails(), resetTrainDetails(), resetPassengerDetails(), resetPaymentDetails(), resetCardDetails(), resetAdditionalDetails(), clearDirtyFlag(), hideDeleteButton())
}

function resetFormName() {
	document.getElementById("formNameID").value = ""
}

function resetLoginDetails() {
	document.getElementById("usernameId").value = "";
	document.getElementById("j_password").value = ""
}

function resetJourneyPlanDetails() {
	document.getElementById("fromStation").value = "";
	document.getElementById("toStation").value = "";
	document.getElementById("boardingStation").value = "";
	document.getElementById("journeyDateInputDate").value = "";
	document.getElementById("ztTicketTypeSelect").value = "E_TICKET";
	document.getElementById("ztPHConcessionInput").checked = !1
}

function resetTrainDetails() {
	for (var a = $("#qcbd input"), b = 0; b < a.length; ++b) {
		var c = a[b];
		c && !0 == c.checked && (c.checked = !1)
	}
	document.getElementById("trainNumber").value = "";
	a = $("#class input");
	for (b = 0; b < a.length; ++b)
		if ((c = a[b]) && !0 == c.checked) c.checked = !1
}

function resetAdultPassengerDetails(a) {
	5 < a || 0 > a || (document.getElementById("psgnName" + a).value = "", document.getElementById("psgnAge" + a).value = "", document.getElementById("psgnGender" + a).value = " ", document.getElementById("berthChoice" + a).value = "  ", document.getElementById("aadhaarCardNumber" + a).value = "", document.getElementById("concessionOpt" + a).value = "", document.getElementById("mealPref" + a).value = " ", document.getElementById("concessionType" + a).value = " ", document.getElementById("handicapCardNo" + a).value =
		"", document.getElementById("psgnDoB" + a).value = "", document.getElementById("validUpto" + a).value = "")
}

function resetChildPassengerDetails(a) {
	1 < a || 0 > a || (document.getElementById("infantName" + a).value = "", document.getElementById("infantAge" + a).value = -1, document.getElementById("infantGender" + a).value = " ")
}

function resetPassengerDetails() {
	for (var a = 0; 6 > a; ++a) document.getElementById("psgnName" + a).value = "", document.getElementById("psgnAge" + a).value = "", document.getElementById("psgnGender" + a).value = " ", document.getElementById("berthChoice" + a).value = "  ", document.getElementById("aadhaarCardNumber" + a).value = "", document.getElementById("concessionOpt" + a).value = "", document.getElementById("mealPref" + a).value = " ", document.getElementById("concessionType" + a).value = " ", document.getElementById("handicapCardNo" + a).value =
		"", document.getElementById("psgnDoB" + a).value = "", document.getElementById("validUpto" + a).value = "";
	for (a = 0; 2 > a; ++a) document.getElementById("infantName" + a).value = "", document.getElementById("infantAge" + a).value = -1, document.getElementById("infantGender" + a).value = " "
}

function resetAdditionalDetails() {
	document.getElementById("mobileNo").value = "";
	document.getElementById("autoUpgrade").checked = !1;
	document.getElementById("onlyConfirmBerths").checked = !1;
	for (var a = $("#bookingCondRadioButtonGroup input"), b = 0; b < a.length; ++b) {
		var c = a[b];
		c.checked = c && 3 == c.value ? "checked" : !1
	}
	document.getElementById("prefCoachOpt").checked = !1;
	document.getElementById("coachID").value = "";
	document.getElementById("coachID").disabled = !0
}

function resetPaymentDetails() {
	for (var a = $("#paymentType input"), b = 0; b < a.length; ++b) {
		var c = a[b];
		c && !0 == c.checked && (c.checked = !1)
	}
	document.getElementById("bankINBList").value = -1;
	document.getElementById("bankPGList").value = -1;
	document.getElementById("bankDCList").value = -1;
	document.getElementById("bankCCList").value = -1;
	document.getElementById("bankEMIList").value = -1;
	document.getElementById("bankPrepaidList").value = -1
}

function resetCardDetails() {
	document.getElementById("card_type_id").value = "";
	document.getElementById("card_no_id").value = "";
	document.getElementById("card_expiry_mon_id").value = "mm";
	document.getElementById("card_expiry_year_id").value = "";
	document.getElementById("cvv_no_id").value = "";
	document.getElementById("card_name_id").value = "";
	hideCreditCardDetailsDiv()
}

function addValidationForNumberControls() {
	$(".only_numbers").keypress(validateForNumber);
	document.getElementById("card_no_id").addEventListener("input", fomatCreditCardNumber)
}

function validateForNumber(a) {
	if (8 == (a.which ? a.which : a.keyCode)) return !0;
	var b = void 0;
	if (window.event) b = a.keyCode;
	else if (a.which) b = a.which;
	else return !0;
	return /[0-9]/.test(String.fromCharCode(b))
}

function fomatCreditCardNumber() {
	var a = document.getElementById("card_no_id"),
	b = a.value,
	b = b.trim();
	5 == b.length ? b = b.substring(0, 4) + " " + b.substring(4, 5) : 10 == b.length ? b = b.substring(0, 9) + " " + b.substring(9, 10) : 15 == b.length ? b = b.substring(0, 14) + " " + b.substring(14, 15) : 20 == b.length && (b = b.substring(0, 19) + " " + b.substring(19, 20));
	a.value = b
}

function swapToNFroStations() {
	var a = void 0,
	b = document.getElementById("fromStation"),
	c = document.getElementById("toStation"),
	d = document.getElementById("boardingStation"),
	a = b.value;
	b.value = c.value;
	c.value = a;
	d.value = b.value;
	setDirtyFlag()
}

function initializeScroller() {
	$(window).scroll(function() {
		100 < $(this).scrollTop() ? $("#scrollup").fadeIn() : $("#scrollup").fadeOut()
	});
	$("#scrollup").click(function() {
		$("html, body").animate({
			scrollTop: 0
		}, 600);
		return !1
	})
}

function shareFormDetails() {};